print("hi")
UVKs_plus_dR <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam_plus_dR, VZ = VZ, surface = params$surface))
print("hi")
}
} else if (params$windVortexModel == 1) {
UV <- with(TRACK, HubbertWindField(rMax = rMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam, V = V, surface = params$surface))
} else if (params$windVortexModel == 2) {
UV <- with(TRACK, McConochieWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, Rlam = Rlam, V = V, f = f, surface = params$surface))
}
UVKs
# Extract wind components
ept <- GEO_land["lons"] / GEO_land["lons"]
Pr <- ept
terra::values(Pr) <- P
Uw <- ept
terra::values(Uw) <- UV[, 1]
Vw <- ept
terra::values(Vw) <- UV[, 2]
# Calculate wind speed and wind direction
Sw <- sqrt(Uw^2 + Vw^2)
Va <- terra::atan2(Vw, Uw)
#add pi to get direction from, then remove direction from from 90 to get clockwise from north
Dw <- 90 - (Va - pi ) * 180 / pi # Convert to clockwise from true north
Dwv <- terra::values(Dw)
# Adjust wind direction to be within the range [0, 360]
s <- which(Dwv < 0 & !is.na(Dwv))
if (length(s) > 0) {
Dw[s] <- 360 + Dw[s]
}
s <- which(Dwv > 360 & !is.na(Dwv))
if (length(s) > 0) {
Dw[s] <- Dw[s] - 360
}
# Calculate wind decay based on surface roughness
decay <- 1
a <- c(params$Decay_a1, params$Decay_a2, params$Decay_a3)
if (a[1] != 0 & params$surface == 1) {
decay <- inlandWindDecay(GEO_land$inlandD / 1000, a)
decay[is.na(decay)] <- 1
}
# Bias-correct winds and correct for surface roughness
Sw <- Sw * decay
Uw <- cos(Va) * Sw
Vw <- sin(Va) * Sw
R <- ept
terra::values(R) <- Rlam[,1]
lam <- ept
terra::values(lam) <- Rlam[,2]
returnWaves
if(returnWaves){
# significant wave heights OGrady 2024 JCR eq 1
Sww = Sw
Sww[R < TRACK$rMax & Sww < 10] = 10 #lift winds in the eye so there are always waves
dP = params$eP-TRACK$PRES
Hs0 = params$Wave_a*Sww^params$Wave_x + params$Wave_b*TRACK$dPs + params$Wave_c*TRACK$vFm
Hs0[Hs0 <0] = 0
Hs0[GEO_land$dem > 0] = NA
Hs0[R < TRACK$rMax & Hs0 < 2] = 2
# wave period Young 2017 eq 4
e0 = 96.04*(Hs0^2/16)/(Sww^4)
nu0 = (e0/6.365e-6)^-0.303
Tp0 = Sww/(nu0*9.8)
#Wave directions
fs = sign(TRACK$f)
d = fs*c(0.0,   22.5,   67.5,  112.5,  157.5,180,-180, -157.5, -112.5,  -67.5,  -22.5,  -0.01)
#Wave ang outward from the wind Tamizi & Young 2020 (Pers comms)
TRACK$thetaFm[TRACK$thetaFm < -180] =  360+TRACK$thetaFm[TRACK$thetaFm < -180]
TRACK$thetaFm[TRACK$thetaFm > 180] = -360+TRACK$thetaFm[TRACK$thetaFm >= 180]
wwang = fs*c(54,52,36,27,16,56,56,92,104,79,56,54)
ang = (90.0-lam) - (90-TRACK$thetaFm) #orientate clockwise to the forward motion thetaFm in degrees
ang[ang < -180] =  360+ang[ang < -180]
ang[ang >= 180] = -360+ang[ang >= 180]
p2av = approx(d,wwang,values(ang))$y
p2a <- ept
terra::values(p2a) <- p2av
Dp0 = Dw-180+p2a
Dp0[Dp0 < 0] = 360 + Dp0[Dp0 < 0]
Dp0[GEO_land$dem > 0] = NA
terra::time(Hs0) <- indate
terra::units(Hs0) <- "m"
terra::longnames(Hs0) <- "Deep_water_significant_wave_height"
terra::time(Tp0) <- indate
terra::units(Tp0) <- "s"
terra::longnames(Tp0) <- "peak_wave_period"
terra::time(Dp0) <- indate
terra::units(Dp0) <- "Deg"
terra::longnames(Dp0) <- "peak_wave_direction"
}
params$windVortexModel == 0 & returnVerticalWind
print("hi")
UVKs_plus_dR
Ww = Sw*NA
Sw_plus_dR = Ww
srt = sqrt(UVKs_plus_dR[,1]^2+UVKs_plus_dR[,2]^2)/UVKs_plus_dR[,3]
values(Sw_plus_dR) = srt
params$windVortexModel == 0
#V_bwd <- Sw*NA
#values(V_bwd) <- terra::extract(Sw,cd_b)
V_fwd = Sw_plus_dR
V_bwd = Sw/Ks/decay
V_bwd = Sw_plus_dR*NA
values(V_bwd) = values(Sw)/values(Ks)/values(decay)
Sw
Ks
decay
values(Ksr) = Ks
Ksr = Sw_plus_dR*NA
values(Ksr) = Ks
V_bwd = Sw/Ksr/decay
# Estimate radial derivative of wind (∂V/∂r), converting spacing to km
#mean_dx_km <- dx * 111  # very rough (1 deg ≈ 111 km at equator)
#dVdr <- (V_fwd - V_bwd) / (2 * mean_dx_km)
dVdr <- (V_fwd - V_bwd) / 10
# Use existing Sw as V, and vs = Sw as surface wind approximation (approximate V + 2*vs term)
Ks = Sw*NA
values(Ks) <- UVKs[,3]
Ks = Sw*NA
values(Ks) <- UVKs[,3]
V_bwd = Sw/Ks/decay
# Estimate radial derivative of wind (∂V/∂r), converting spacing to km
#mean_dx_km <- dx * 111  # very rough (1 deg ≈ 111 km at equator)
#dVdr <- (V_fwd - V_bwd) / (2 * mean_dx_km)
dVdr <- (V_fwd - V_bwd) / 10
# Use existing Sw as V, and vs = Sw as surface wind approximation (approximate V + 2*vs term)
Vs <- V_bwd
vs <- Sw/decay
# Drag coefficient (same as in KepertWindField.cpp)
Cd <- 0.002
# Compute vertical velocity (w_inf), valid above boundary layer Kepert 2001
numerator <- Cd * Vs * (Vs + 2 * vs)
denominator <- GEO_land$f + Vs / R + dVdr
Ww <- (1 / R) * (numerator / denominator)
plot(Ww)
R
plot(R)
plot(Ww)
plot(Ww*1000)
plot(Ww*100)
# Compute vertical velocity (w_inf), valid above boundary layer Kepert 2001
numerator <- R * Cd * Vs * (Vs + 2 * vs)
denominator <- GEO_land$f + Vs / R + dVdr
Ww <- (1 / R) * (numerator / denominator)
plot(Ww)
Cd
Vs
plot(Vs)
plot(vs)
# Compute vertical velocity (w_inf), valid above boundary layer Kepert 2001
numerator <- R * Cd * Vs * (Vs + 2 * vs)
denominator <- GEO_land$f + Vs / R + dVdr
Ww <- (1 / R) * (numerator / denominator)
plot(Ww)
plot(dVdr)
# Estimate radial derivative of wind (∂V/∂r), converting spacing to km
#mean_dx_km <- dx * 111  # very rough (1 deg ≈ 111 km at equator)
#dVdr <- (V_fwd - V_bwd) / (2 * mean_dx_km)
dVdr <- (V_fwd - V_bwd) / .010
# Estimate radial derivative of wind (∂V/∂r), converting spacing to km
#mean_dx_km <- dx * 111  # very rough (1 deg ≈ 111 km at equator)
#dVdr <- (V_fwd - V_bwd) / (2 * mean_dx_km)
dVdr <- (V_fwd - V_bwd) / .010
# Use existing Sw as V, and vs = Sw as surface wind approximation (approximate V + 2*vs term)
Vs <- V_bwd
vs <- Sw/decay
# Drag coefficient (same as in KepertWindField.cpp)
Cd <- 0.002
# Compute vertical velocity (w_inf), valid above boundary layer Kepert 2001
numerator <- R * Cd * Vs * (Vs + 2 * vs)
denominator <- GEO_land$f + Vs / R + dVdr
Ww <- (1 / R) * (numerator / denominator)
plot(Ww)
# Calculate wind vortex field based on the selected model
if (params$windVortexModel == 0) {
UVKs <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam, VZ = VZ, surface = params$surface))
UV <- UVKs[,1:2]
Ks <- UVKs[,3]
if(returnVerticalWind){
print("hi")
Rlam_plus1_dR = Rlam #calculate the winds gradient 10 m in the outward radial direction
Rlam_plus1_dR[,1] = Rlam_plus_dR[,1]+.01 #10 metres
Rlam_plus2_dR = Rlam #calculate the winds gradient 20 m in the outward radial direction
Rlam_plus2_dR[,1] = Rlam_plus_dR[,1]+.02 #10 metres
UVKs_plus1_dR <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam_plus1_dR, VZ = VZ, surface = params$surface))
UVKs_plus2_dR <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam_plus2_dR, VZ = VZ, surface = params$surface))
}
} else if (params$windVortexModel == 1) {
UV <- with(TRACK, HubbertWindField(rMax = rMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam, V = V, surface = params$surface))
} else if (params$windVortexModel == 2) {
UV <- with(TRACK, McConochieWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, Rlam = Rlam, V = V, f = f, surface = params$surface))
}
print("hi")
Ww = Sw*NA
Sw_plus1_dR = Ww
Sw_plus2_dR = Ww
srt = sqrt(UVKs_plus1_dR[,1]^2+UVKs_plus1_dR[,2]^2)/UVKs_plus1_dR[,3]
values(Sw_plus1_dR) = srt
srt = sqrt(UVKs_plus2_dR[,1]^2+UVKs_plus2_dR[,2]^2)/UVKs_plus2_dR[,3]
values(Sw_plus2_dR) = srt
Sw_plus2_dR
plot(Sw_plus2_dR)
plot(Sw_plus1_dR)
UVKs_plus1_dR <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam_plus1_dR, VZ = VZ, surface = params$surface))
UVKs_plus1_dR
UVKs_plus1_dR[,4]
UVKs_plus1_dR = cbind(UVKs_plus1_dR,sqrt(UVKs_plus1_dR[,1]^2 + UVKs_plus1_dR[,2]^2))
UVKs_plus2_dR = cbind(UVKs_plus2_dR,sqrt(UVKs_plus2_dR[,1]^2 + UVKs_plus2_dR[,2]^2))
111000/0.02
Rlam
UVKs <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam, VZ = VZ, surface = params$surface))
UV <- UVKs[,1:2]
Ks <- UVKs[,3]
print("hi")
Rlam_plus1_dR = Rlam #calculate the winds gradient 10 m in the outward radial direction
Rlam_plus1_dR[,1] = Rlam[,1]+.01 #10 metres
Rlam_plus2_dR = Rlam #calculate the winds gradient 20 m in the outward radial direction
Rlam_plus2_dR[,1] = Rlam[,1]+.02 #10 metres
UVKs_plus1_dR <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam_plus1_dR, VZ = VZ, surface = params$surface))
UVKs_plus2_dR <- with(TRACK, KepertWindField(rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f, Rlam = Rlam_plus2_dR, VZ = VZ, surface = params$surface))
UVKs = cbind(UVKs,sqrt(UVKs[,1]^2 + UVKs[,2]^2))
UVKs_plus1_dR = cbind(UVKs_plus1_dR,sqrt(UVKs_plus1_dR[,1]^2 + UVKs_plus1_dR[,2]^2))
UVKs_plus2_dR = cbind(UVKs_plus2_dR,sqrt(UVKs_plus2_dR[,1]^2 + UVKs_plus2_dR[,2]^2))
numOnDom = function(UVKsWs1,UVKsWs2,R,f){
#Gradient wind speed
V_fwd <- UVKsWs2[,4]/UVKsWs2[,3]
V_bwd <- UVKsWs1[,4]/UVKsWs1[,3]
dVdr <- (V_fwd - V_bwd) / 10
#surface wind speed
vs <- UVKsWs1[,4]
Cd <- 0.002
numerator <- R * Cd * Vs * (Vs + 2 * vs)
denominator <- GEO_land$f + Vs / R + dVdr
return(numerator / denominator)
}
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,Rlam[,1])
numOnDom = function(UVKsWs1,UVKsWs2,R,f){
#Gradient wind speed
V_fwd <- UVKsWs2[,4]/UVKsWs2[,3]
V_bwd <- UVKsWs1[,4]/UVKsWs1[,3]
dVdr <- (V_fwd - V_bwd) / 10
#surface wind speed
vs <- UVKsWs1[,4]
Cd <- 0.002
numerator <- R * Cd * V_bwd * (V_bwd + 2 * vs)
denominator <- GEO_land$f + V_bwd / R + dVdr
return(numerator / denominator)
}
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,Rlam[,1],f = GEO_land$f)
UVKsWs1 = UVKs
UVKsWs2 = UVKs_plus1_dR
R =  Rlam[,1]
f = GEO_land$f
f
f = values(GEO_land$f)
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,R =  Rlam[,1],f = f)
numOnDom = function(UVKsWs1,UVKsWs2,R,f){
#Gradient wind speed
V_fwd <- UVKsWs2[,4]/UVKsWs2[,3]
V_bwd <- UVKsWs1[,4]/UVKsWs1[,3]
dVdr <- (V_fwd - V_bwd) / 10
#surface wind speed
vs <- UVKsWs1[,4]
Cd <- 0.002
numerator <- R * Cd * V_bwd * (V_bwd + 2 * vs)
denominator <- f + V_bwd / R + dVdr
return(numerator / denominator)
}
f = values(GEO_land$f)
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,R =  Rlam[,1],f = f)
numOnDom2 <- numOnDom(UVKs_plus1_dR,UVKs_plus2_dR,Rlam_plus1_dR[,1],f = f)
Ww = 1/Rlam[,1] * (numOnDom2-numOnDom1) / 10
Wm2 =  GEO_land["lons"] / GEO_land["lons"]
values(Wm2) <- Ww
plot(Wm2)
Rlam[,1]
numOnDom2
(numOnDom2-numOnDom1
_
(numOnDom2-numOnDom1)
(numOnDom2-numOnDom1)/10
(numOnDom2-numOnDom1)/0.01
numOnDom = function(UVKsWs1,UVKsWs2,R,f){
#Gradient wind speed
V_fwd <- UVKsWs2[,4]/UVKsWs2[,3]
V_bwd <- UVKsWs1[,4]/UVKsWs1[,3]
dVdr <- (V_fwd - V_bwd) / 0.01
#surface wind speed
vs <- UVKsWs1[,4]
Cd <- 0.002
numerator <- R * Cd * V_bwd * (V_bwd + 2 * vs)
denominator <- f + V_bwd / R + dVdr
return(numerator / denominator)
}
f = values(GEO_land$f)
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,R =  Rlam[,1],f = f)
numOnDom2 <- numOnDom(UVKs_plus1_dR,UVKs_plus2_dR,Rlam_plus1_dR[,1],f = f)
VertWind = (1/Rlam[,1]) * (numOnDom2-numOnDom1) / 0.01
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- VertWind
plot(VertWind)
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- VertWind
plot(Ws)
numOnDom = function(UVKsWs1,UVKsWs2,R,f){
#Gradient wind speed
V_fwd <- UVKsWs2[,4]/UVKsWs2[,3]
V_bwd <- UVKsWs1[,4]/UVKsWs1[,3]
dVdr <- (V_fwd - V_bwd) / 10
#surface wind speed
vs <- UVKsWs1[,4]
Cd <- 0.002
numerator <- R * Cd * V_bwd * (V_bwd + 2 * vs)
denominator <- f + V_bwd / R + dVdr
return(numerator / denominator)
}
f = values(GEO_land$f)
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,R =  Rlam[,1]*1000,f = f)
numOnDom2 <- numOnDom(UVKs_plus1_dR,UVKs_plus2_dR,Rlam_plus1_dR[,1]*1000,f = f)
VertWind = (1/Rlam[,1]*1000) * (numOnDom2-numOnDom1) / 10
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- VertWind
plot(Ws)
values(Ws) <- numOnDom1
plot(Ws)
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,R =  Rlam[,1],f = f)
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- numOnDom1
plot(Ws)
f = values(GEO_land$f)
numOnDom1 <- numOnDom(UVKs,UVKs_plus1_dR,R =  Rlam[,1],f = f)
numOnDom2 <- numOnDom(UVKs_plus1_dR,UVKs_plus2_dR,Rlam_plus1_dR[,1],f = f)
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- numOnDom1
values(Ws) <- numOnDom2
plot(Ws)
VertWind = (1/Rlam[,1]*1000) * (numOnDom2-numOnDom1) / 10
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- numOnDom2-numOnDom1
plot(Ws)
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- 1/Rlam[,1]
plot(Ws)
values(Ws) <- UVKs_plus1_dR[,4]
plot(Ws)
values(Ws) <- UVKs_plus2_dR[,4]
plot(Ws)
values(Ws) <- UVKs_plus2_dR[,4]-UVKs_plus2_dR[,3]
plot(Ws)
values(Ws) <- UVKs_plus2_dR[,4]-UVKs_plus1_dR[,4]
plot(Ws)
values(Ws) <- UVKs_plus2_dR[,4]-UVKs[,4]
plot(Ws)
library(Rcpp)
sourceCpp("src/verticalWind.cpp")   # compiles and loads
UVKsw <- KepertVerticalWindField(
rMax, vMax, vFms, thetaFms, f,
Rlam, VZ, surface = params$surface,
dr_m = 10.0
)
UVKs_plus2_dR <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam_plus2_dR, VZ = VZ, surface = params$surface,
dr_m = 10.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- UVKs_plus2_dR[,4]
plot(Ws)
plot(Ws,range = c(-10,10))
plot(Ws,range = c(-100,100))
plot(Ws,range = c(0,100))
plot(Ws,range = c(-100,100))
library(Rcpp)
sourceCpp("verticalWind.cpp")
UVKs_plus2_dR <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam_plus2_dR, VZ = VZ, surface = params$surface,
dr_m = 100.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- UVKs_plus2_dR[,4]
plot(Ws,range = c(-100,100))
UVKs_plus2_dR <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 100.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- UVKs_plus2_dR[,4]
plot(Ws,range = c(-100,100))
values(Ws) <- UVKs_plus2_dR[,3]
plot(Ws,range = c(-100,100))
plot(Ws)#,range = c(-100,100))
values(Ws) <- UVKs_plus2_dR[,1]
plot(Ws)#,range = c(-100,100))
values(Ws) <- UVKs_plus2_dR[,4]
plot(Ws)#,range = c(-100,100))
values(Ws) <- log(UVKs_plus2_dR[,4])
plot(Ws)#,range = c(-100,100))
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 10.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- log(v[,4])
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- log(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
sourceCpp("verticalWind.cpp")
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 10.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- log(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
values(Ws) <- (UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
values(Ws) <- (UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
f
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 10.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
sourceCpp("verticalWind.cpp")
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
sourceCpp("verticalWind.cpp")
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
Rcpp::sourceCpp("verticalWind.cpp")
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- -(UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
Rlam
V
VZ
summary(VZ)
Rcpp::sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- (UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
plot(Ws)#,range = c(-10,10))
plot(Ws),range = c(-10,10))
plot(Ws,range = c(-10,10))
sourceCpp("verticalWind.cpp")
UVKsWs <- with(TRACK, KepertVerticalWindField(
rMax = rMax, vMax = vMax, vFm = vFms, thetaFm = thetaFms, f = f,
Rlam = Rlam, VZ = VZ, surface = params$surface,
dr_m = 50.0  # optional; defaults to 10 m
))
Ws <- GEO_land["lons"] / GEO_land["lons"]
values(Ws) <- (UVKsWs[,4])
plot(Ws)#,range = c(-100,100))
values(Ws) <- (UVKsWs[,3])
plot(Ws)#,range = c(-100,100))
values(Ws) <- (UVKsWs[,1])
plot(Ws)#,range = c(-100,100))
a = NULL
missing(a)
